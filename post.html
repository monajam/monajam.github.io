<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Post</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
      </head>
  
  <body>
    
     <nav class="navbar navbar-expand-lg navbar-light" style="background-color: #6e8b3d;">
      <a class="navbar-brand" href="#">monajam.github.io</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo01" aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarTogglerDemo01">
    <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
      <li class="nav-item"><a class="nav-link" href="https://monajam.github.io/">Home</a></li>
      <li class="nav-item active"><a class="nav-link" href="https://monajam.github.io/post">Post</a></li>
      <li class="nav-item"><a class="nav-link" href="https://monajam.github.io/chat">Chat</a></li>
       <li class="nav-item"><a class="nav-link" href="https://monajam.github.io/about">About</a></li>
    </ul>
  </div>
       
       <ul class="nav navbar-nav navbar-right">
        <li><input id="author" name="author" type="text" placeholder="Steemit Username" class="form-control input-md" required=""></li>
        <li><input id="privatekey" name="privatekey" type="text" placeholder="Private Posting Key" class="form-control input-md" required=""></li>
</ul>
       
       
</nav>
    
<br/>
    
    
<div class="container-fluid">
  
      <div class="row">
    <div class="col-sm-4">
      
      <img src="https://steemitimages.com/u/monajam/avatar"/>
      
      
      <h2>MonaJam's App - Reward Hub</h2>
      
       <hr/>
      <!--Paste widget under this-->
      
      
      <!-- Rules -->
<div class="col" style="background:#fffaf0;color:black;padding:10px;">     
            
  Reward Hub is basic posting app of @monajam. You can use it to post on Steemit and be eligible for a 20% of upvote from @monajam.<br/>
  <span style="color:#ff7256;">...........xxxx..........</span></br>
  .......xxx........</br>
     <hr/>  
            
  <p>.....under development..........</p>
       <hr/>                                                                                     
      <b>........Posting rules........:</b>       </br>
  1. Original content.</br>
  2. Post has to be created with this app.</br>
                                                                  
   </div>
      
    </div>
    
<div class="col-sm-8"> 
  <!--Posting app-->
  
  <form class="form-horizontal" id='post'>
        <fieldset>

<!-- Form Name -->
          <center><legend>Create a post on Steemit with this app and get a 20% upvote from <a href="https://steemit.com/@monajam">@monajam</a></legend>
          </center>

<!-- Text input-->
        <div class="form-group">
          <label class="col control-label" for="title">Title<span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></label>  
          <div class="col">
          <input id="title" name="title" type="text" placeholder="Write your title here" class="form-control input-md" required="">
          </div>
        </div>

<!-- Text input-->
        <div class="form-group">
          <label class="col control-label" for="permlink">Link<span class="glyphicon glyphicon-link" aria-hidden="true"></span></label>  
          <div class="col">
          <input id="permlink" name="permlink" type="text" placeholder="Link will be auto-added when you write a title" class="form-control input-md" required="">
          </div>
        </div>

        <!-- Textarea -->
        <div class="form-group">
          <label class="col-md-4 control-label" for="markdown">Post Content (Markdown/HTML)</label><br/>
          <div class="col-md-8">
            <textarea class="form-control" id="markdown" name="markdown" rows='10'></textarea>
          </div>
        </div>

        <!-- Text input-->
        <div class="form-group">
          <label class="col-md-4 control-label" for="tags">Tags</label>  <br/>
          <div class="col-md-8">
          <input id="tags" name="tags" type="text" placeholder="" class="form-control input-md" required="">
          <span class="help-block">Use spaces to separate tags.</span>
            <span class="help-block">Add space after the last tag.</span>
          </div>
        </div>

        <!-- Text input-->
        <div class="form-group">
          <span class="help-block">Wallet -> Permissions -> Private Posting Key</span><br/> 
          <span class="help-block"><b>Private posting key is not saved by this application.</b></span> <br/> 
          <span class="help-block">10% beneficiaries will be used to power up</span>  <br/> 
          </div>
        </div>

       

        <!-- Button -->
        <div class="form-group">
          <label class="col-md-4 control-label" for="post"></label>
          <div class="col-md-4">
            <button id="post" name="post" class="btn btn-primary"><span class="glyphicon glyphicon-send" aria-hidden="true"></span> Publish</button>
          </div>
        </div>

        </fieldset>
      </form>



      <div id='successalert' class="alert alert-success" style='display:none'>
        <strong>Success!</strong> Your post is now public on the blockchain.
      </div>

      <div id='infoalert' class="alert alert-info" style='display:none'>
        <strong>Please wait</strong> Submitting your post...
      </div>

      <div id='erroralert' class="alert alert-danger" style='display:none'>
        <strong>Error!</strong> <span id='errormessage'></span>
      </div>

    </div>
    	
</div>
  
  
</div>
    
  
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.6/Chart.min.js"></script>    
    <script src="//cdn.steemjs.com/lib/latest/steem.min.js"></script>
    <script type="text/javascript">
      beneficiaries = [{
                "account": "monajam", 
                "weight": 1000
            }]
      weightRemaining = 9000
      tags = []
      $('#title').keydown(function() {
        var permlink = $(this).val().toLowerCase()
          .replace(/ /g,'-')
          .replace(/[^\w-]+/g,'')
        $('#permlink').val(permlink)
      })
      $('#tags').keydown(function() {
        tags = $(this).val().split(' ')
      })
      $('#benefadd').click(function() {
        for (var i = beneficiaries.length - 1; i >= 0; i--) {
          if (beneficiaries[i].account == $('#benefusername').val()) {
            weightRemaining += beneficiaries[i].weight;
            beneficiaries.splice(i,1);
          }
        };
        beneficiaries.push({
          account: $('#benefusername').val(),
          weight: 100*$('#benefshare').val()
        })
        weightRemaining -= 100*$('#benefshare').val()
        displayBenefs()
      })
      function displayBenefs() {
        $('#beneflist').empty()
        for (var i = beneficiaries.length - 1; i >= 0; i--) {
          var html = '<li>'+beneficiaries[i].account+' ('+beneficiaries[i].weight/100+'%) <button type="button" class="btn btn-danger btn-xs removeBenef" data-account="'+beneficiaries[i].account+'">x</button></li>'
          $('#beneflist').append(html)
        };
        $('#weightRemaining')[0].innerHTML = weightRemaining/100;
        $('.removeBenef').click(function(e) {
          console.log($(this).data('account'))
          for (var i = beneficiaries.length - 1; i >= 0; i--) {
            if (beneficiaries[i].account == $(this).data('account')) {
              weightRemaining += beneficiaries[i].weight;
              beneficiaries.splice(i,1);
              displayBenefs()
            }
          };
        })
      }
      $('#post').submit(function(event) {
        event.preventDefault();
        $('#infoalert').show()
        $('#successalert').hide()
        $('#erroralert').hide()
        var title = $('#title').val();
        var permlink = $('#permlink').val();
        var markdown = $('#markdown').val();
        var author = $('#author').val();
        var privatekey = $('#privatekey').val();
        var sbdpercent = 100;
        var maxpayout = 1000000;
        var operations = [
          ['comment',
            {
              parent_author: '',
              parent_permlink: tags[0],
              author: author,
              permlink: permlink,
              title: title,
              body: markdown,
              json_metadata : JSON.stringify({
                tags: tags,
                app: 'posting personal app'
              })
            }
          ],
          ['comment_options', {
            author: author,
            permlink: permlink,
            max_accepted_payout: maxpayout+'.000 SBD',
            percent_steem_dollars: sbdpercent,
            allow_votes: true,
            allow_curation_rewards: true,
            extensions: [
              [0, {
                beneficiaries: beneficiaries
              }]
            ]
          }]
        ];
        if (beneficiaries.length == 0) {
          operations[1][1].extensions = []
        }
        console.log(operations)
        steem.broadcast.send(
          { operations: operations, extensions: [] },
          { posting: privatekey },
          function(e, r) {
            $('#infoalert').hide()
            if (e) {
              $('#errormessage').html(e.message)
              $('#erroralert').show()
            } else {
              $('#successalert').show()
            }
            console.log(e,r)
          }
        )
      });
    </script>
  <!--End Posting app-->
      
        </div>
  
  
  <footer class="container-fluid text-center" style='background-color:#6e8b3d; color: white; margin-top: 15px;'>
  <div style="margin-top:15px;">
    
      <h3><a href="https://steemauto.com/dash.php?i=1&amp;trail=monajam"><strong>Join</strong></a> the curation trail of @monajam</h3>
      
  </div>
</footer> 
 </body> 
</html>
