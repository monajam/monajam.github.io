<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Reward Hub</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
      
  
  
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
<script type="text/javascript">
counter = function() {
    var value = $('#markdown').val();
    if (value.length == 0) {
        $('#wordCount').html(0);
        $('#totalChars').html(0);
        $('#charCount').html(0);
        $('#charCountNoSpace').html(0);
        return;
    }
    var regex = /\s+/gi;
    var wordCount = value.trim().replace(regex, ' ').split(' ').length;
    var totalChars = value.length;
    var charCount = value.trim().length;
    var charCountNoSpace = value.replace(regex, '').length;
    $('#wordCount').html(wordCount);
    $('#totalChars').html(totalChars);
    $('#charCount').html(charCount);
    $('#charCountNoSpace').html(charCountNoSpace);
};
$(document).ready(function() {
    $('#markdown').change(counter);
    $('#markdown').keydown(counter);
    $('#markdown').keypress(counter);
    $('#markdown').keyup(counter);
    $('#markdown').blur(counter);
    $('#markdown').focus(counter);
});
</script>
  
  </head>
  
  <body>
    
     <nav class="navbar navbar-expand-lg navbar-light" style="background-color: #8b7d6b;">
      <a class="navbar-brand" href="#">MonaJam's App</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo01" aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarTogglerDemo01">
    <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
      <li class="nav-item"><a class="nav-link" href="https://monajam.github.io/">Home</a></li>
      <li class="nav-item"><a class="nav-link" href="https://monajam.github.io/chat">Chat</a></li>
       <li class="nav-item"><a class="nav-link" href="https://monajam.github.io/about">About</a></li>
    </ul>
  </div>
       
       <ul class="nav navbar-nav navbar-right">
        <li><input id="author" name="author" type="text" placeholder="Steemit Username" class="form-control input-md" required=""></li>
        <li><input id="privatekey" name="privatekey" type="text" placeholder="Private Posting Key" class="form-control input-md" required=""></li>
</ul>
       
       
</nav>
    
<br/>
    
    
<div class="container-fluid">
  
      <div class="row">
    <div class="col-sm-4">
      
      <img src="https://steemitimages.com/u/monajam/avatar"/>
      
      
      <h2>Reward Hub</h2>
      
       <hr/>
      <!--Paste widget under this-->
      
      
      <!-- Rules -->
<div class="col" style="background:#fffaf0;color:black;padding:10px;">     
            
  Reward Hub is a basic posting application through which you can post on Steemit and can be eligible for a 20% upvote from <a href="https://steemit.com/@monajam">@monajam</a>.<br/>
  The application does not save your private posting key.<br/>
  <h4>To find the private posting key...</h4>
<p>&nbsp;Go to Wallet -&gt; Permissions -&gt; Private Posting Key&nbsp;</p>
  <h4>You will be eligible for an upvote if you follow these rules:</h4>
<ul>
  <li>Post has to be created with this app.</li>
  <li>Post should be in English.</li>
  <li>The first tag should be 'rewardhub'.</li>
  <li>Original content only.</li>
  <li>Minimum words: 500.</li>
  <li>Post should be well-formatted.</li>
  <li>Content should be well-referenced.</li>
</ul>
  <span style="color:#ff7256;">...........xxxx..........</span></br>
  .......xxx........</br>
     <hr/>                       
   </div>
      
    </div>
    
<div class="col-sm-8"> 
  <!--Posting app-->
  
  <form class="form-horizontal" id='post'>
        <fieldset>

<!-- Form Name -->
          <center><legend>Create a post on Steemit with this app and get a 20% upvote from <a href="https://steemit.com/@monajam">@monajam</a></legend>
          </center>

<!-- Text input-->
        <div class="form-group">
          <label class="col control-label" for="title">Title<span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></label>  
          <div class="col">
          <input id="title" name="title" type="text" placeholder="Your title here..." class="form-control input-md" required="">
          </div>
        </div>

<!-- Text input-->
        <div class="form-group">
          <label class="col control-label" for="permlink">Link<span class="glyphicon glyphicon-link" aria-hidden="true"></span></label>  
          <div class="col">
          <input id="permlink" name="permlink" type="text" placeholder="Link will be auto-added when you write a title" class="form-control input-md" required="">
          </div>
        </div>

        <!-- Textarea -->
        <div class="form-group">
          <label class="col-md-4 control-label" for="markdown">Content (Markdown/HTML)</label><br/>
          <div class="col-md-10">
            <textarea class="form-control" placeholder="Your content here..." id="markdown" name="markdown" rows='10'></textarea>
            <div id="result">
            Words: <span id="wordCount">0</span><br/>
            Characters (excluding all spaces): <span id="charCountNoSpace">0</span>
</div>
          </div>
        </div>

        <!-- Text input-->
        <div class="form-group">
          <label class="col-md-4 control-label" for="tags">Tags</label>  <br/>
          <div class="col-md-10">
          <input id="tags" name="tags" type="text" placeholder="Use 4 tags separated by a space; add space after the last tag" class="form-control input-md" required="">
          
          </div>
      

        <!-- Text input-->
        <div class="form-group">
          <span class="help-block">10% beneficiaries will be used to power up</span>  <br/> <br/> <br/> 
           <button id="post" name="post" class="btn btn-primary"><span class="glyphicon glyphicon-send" aria-hidden="true"></span> Publish</button>
          </div>
        </div>

  

        </fieldset>
      </form>



      <div id='successalert' class="alert alert-success" style='display:none'>
        <strong>Success!</strong> Your post is now public on the blockchain.
      </div>

      <div id='infoalert' class="alert alert-info" style='display:none'>
        <strong>Please wait</strong> Submitting your post...
      </div>

      <div id='erroralert' class="alert alert-danger" style='display:none'>
        <strong>Error!</strong> <span id='errormessage'></span>
      </div>

    </div>
    	
</div>
  
  
</div>
    
  
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.6/Chart.min.js"></script>    
    <script src="//cdn.steemjs.com/lib/latest/steem.min.js"></script>
    <script type="text/javascript">
      beneficiaries = [{
                "account": "monajam", 
                "weight": 1000
            }]
      weightRemaining = 9000
      tags = []
      $('#title').keydown(function() {
        var permlink = $(this).val().toLowerCase()
          .replace(/ /g,'-')
          .replace(/[^\w-]+/g,'')
        $('#permlink').val(permlink)
      })
      $('#tags').keydown(function() {
        tags = $(this).val().split(' ')
      })
      $('#benefadd').click(function() {
        for (var i = beneficiaries.length - 1; i >= 0; i--) {
          if (beneficiaries[i].account == $('#benefusername').val()) {
            weightRemaining += beneficiaries[i].weight;
            beneficiaries.splice(i,1);
          }
        };
        beneficiaries.push({
          account: $('#benefusername').val(),
          weight: 100*$('#benefshare').val()
        })
        weightRemaining -= 100*$('#benefshare').val()
        displayBenefs()
      })
      function displayBenefs() {
        $('#beneflist').empty()
        for (var i = beneficiaries.length - 1; i >= 0; i--) {
          var html = '<li>'+beneficiaries[i].account+' ('+beneficiaries[i].weight/100+'%) <button type="button" class="btn btn-danger btn-xs removeBenef" data-account="'+beneficiaries[i].account+'">x</button></li>'
          $('#beneflist').append(html)
        };
        $('#weightRemaining')[0].innerHTML = weightRemaining/100;
        $('.removeBenef').click(function(e) {
          console.log($(this).data('account'))
          for (var i = beneficiaries.length - 1; i >= 0; i--) {
            if (beneficiaries[i].account == $(this).data('account')) {
              weightRemaining += beneficiaries[i].weight;
              beneficiaries.splice(i,1);
              displayBenefs()
            }
          };
        })
      }
      $('#post').submit(function(event) {
        event.preventDefault();
        $('#infoalert').show()
        $('#successalert').hide()
        $('#erroralert').hide()
        var title = $('#title').val();
        var permlink = $('#permlink').val();
        var markdown = $('#markdown').val();
        var author = $('#author').val();
        var privatekey = $('#privatekey').val();
        var sbdpercent = 100;
        var maxpayout = 1000000;
        var operations = [
          ['comment',
            {
              parent_author: '',
              parent_permlink: tags[0],
              author: author,
              permlink: permlink,
              title: title,
              body: markdown,
              json_metadata : JSON.stringify({
                tags: tags,
                app: 'posting personal app'
              })
            }
          ],
          ['comment_options', {
            author: author,
            permlink: permlink,
            max_accepted_payout: maxpayout+'.000 SBD',
            percent_steem_dollars: sbdpercent,
            allow_votes: true,
            allow_curation_rewards: true,
            extensions: [
              [0, {
                beneficiaries: beneficiaries
              }]
            ]
          }]
        ];
        if (beneficiaries.length == 0) {
          operations[1][1].extensions = []
        }
        console.log(operations)
        steem.broadcast.send(
          { operations: operations, extensions: [] },
          { posting: privatekey },
          function(e, r) {
            $('#infoalert').hide()
            if (e) {
              $('#errormessage').html(e.message)
              $('#erroralert').show()
            } else {
              $('#successalert').show()
            }
            console.log(e,r)
          }
        )
      });
    </script>
  <!--End Posting app-->
      
        </div>
  
  
  <footer class="container-fluid text-center" style='background-color:#8b7d6b; color: white; margin-top: 15px;'>
  <div style="margin-top:15px;">
    
      <h3><a href="https://steemauto.com/dash.php?i=1&amp;trail=monajam"><strong>Join</strong></a> the curation trail of @monajam</h3>
      
  </div>
</footer> 
 </body> 
</html>
